
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户注册 </title>
    <link rel="shortcut icon" href="images/20190906170231_64693_32.ico" type="image/x-icon" />
    <meta name="Keywords" content="趣呵茶" />
    <meta name="Description" content="趣呵茶" />
    <link href="http://www.hecha.cn/" rel="canonical" />
    <link rel="stylesheet" type="text/css" href="http://www.hecha.cn/css/QuHeCha/Index/main.css">
    <!-- <script type="text/javascript" src="js/jquery.js"></script> -->
    <link rel="stylesheet" type="text/css" href="http://www.hecha.cn/themes/hechav3/skin1/style/users.css">
    <style type="text/css">
        .hc_lnav .allbtn ul
        {
            display: none;
        }
    </style>
</head>
<body>
    <!-- 顶部 -->
    <div class="top-pic">
    <img src="http://www.hecha.cn/images/QuHeCha/Index/toppic.png">
</div>
<div class="top">
    <div class="con clearfix">
        <div class="fr">
            <a href="Cart copy.html" class="order-bg" id="myHechaLink">
                <i class="order"><img src="images/order.png"></i>我的订单
            </a>
            <i class="weChat"><img src="images/wx.png"></i>服务热线：
            <a>188-6042-4332</a>
        </div>
    </div>
</div>
<div class="head">
    <div class="con clearfix">
        <div class="fl logo"><a href="taotao copy.html" target="_blank"><img src="images/logo.png"></a></div>
        <div class="fl brand"><img src="images/brand.gif"></div>
        <div class="fr goods-cart">
            <i class="code"></i>
            <a href="Cart copy.html">
                <i class="cart"></i>
                <span>购物车（<span id="cartCount"></span>）</span>
            </a>
        </div>
    </div>
</div>
 
    <!-- 登录主体 -->
<div class="users_bg">
    <div class="hc_main">
        <div class="hc_reg">
            <div class="left">
                <p class="img">
                    <img id="BackImage" src="http://www.hecha.cn/themes/hechav3/skin1/images/users/login_show1.jpg">
                </p>
            </div>
            <div class="regbox">
                <div class="title">
                    <ul>
                        <li><a id="loginLink" href="denglu.html">登录和茶网</a></li>
                        <li class="on"><a href="zhuce.html">新用户注册</a></li>
                        <div class="clr">
                        </div>
                    </ul>
                </div>
                <div class="list">
                    <ul class="login">
                        <li>
                            <p class="ta">
                                登录名
                            </p>
                            <p class="ip">
                                <input name="LoginAccount" class="input" id="user" type="text">
                            </p>
                            <p class="in">
                                <span id="loginaccount_notice"></span>
                            </p>
                            <div class="clr">
                            </div>
                        </li>
                        
                        <li>
                            <p class="ta">
                                密&nbsp;&nbsp;码
                            </p>
                            <p class="ip">
                                <input name="password" class="input" id="pass" type="password">
                            </p>
                            <p class="in">
                                <span id="password_notice"></span>
                            </p>
                            <div class="clr">
                            </div>
                        </li>
                        <li>
                            <p class="ta">
                                确认密码
                            </p>
                            <p class="ip">
                                <input name="AgainPassWord" class="input" id="pass2" type="password">
                            </p>
                            <p class="in">
                                <span id="conform_password_notice"></span>
                            </p>
                            <div class="clr">
                            </div>
                        </li>
                        <li class="reginp1">
                            <p class="ta">
                                &nbsp;
                            </p>
                            <p class="ip">
                                <input id="btn" name="" type="image" src="images/reg.png" value="Submit" type="button">
                                <span></span>
                            </p>
                            <span id="span" style="font-size: 20px;margin-left:10px;color:deeppink"></span>
                            <div class="clr">
                            </div>
                        </li>
                    </ul>
                    
                </div>
            </div>
            <div class="clr">
            </div>
        </div>
    </div>
</div>

</body>
<script>
    var user = document.getElementById("user");
    var pass = document.getElementById("pass");
    var pass2 = document.getElementById("pass2");
    var btn = document.getElementById("btn");
    //		每个输入框的状态:成功/失败，初始为失败
    var x = false;
    var y = false;
    var z = false;

    user.onblur = function(){
        //用户名的正则
        // console.log(1)
        var reg = /^[\w\-\u2E80-\u9FFF]{4,20}$/
        if(reg.test(this.value)){
            // console.log(1)
            this.parentNode.nextElementSibling.children[0].innerHTML = "可以使用";
            
            x = true
        }else{
            // console.log(2)
            this.parentNode.nextElementSibling.children[0].innerHTML = "不符合规则，请输入中文、字母、数字、“-”“_”的组合，4-20个字符";
            // console.log(this.parentNode.nextElementSibling.children)
            x = false
        }
    }

    pass.onblur = function(){
        if(this.value != pass2.value && pass2.value != ""){
            this.parentNode.nextElementSibling.children[0].innerHTML = "两次不一致";
            z = false
        }
        
        if(this.value.length>=6 && this.value.length<=20){
            //三种情况的开关的定义，出现了一种就对应的改成1
            var a = 0;
            var b = 0;
            var c = 0;
            //是否出现数字的正则
            var numReg = /\d+/g;

            a = numReg.test(this.value) ? 1 : 0;
            
            //是否出现字母的正则
            var azReg = /[a-zA-Z]+/g;

            b = azReg.test(this.value) ? 1 : 0;
            
            //是否出现特殊的正则
            var tsReg = /[^a-zA-Z0-9]+/g;

            c = tsReg.test(this.value) ? 1 : 0;
            
            //三种情况都判断之后,验证开关的结果
            var str = ""
            switch(a+b+c){
                case 1:
                    str = "简单";break;
                case 2:
                    str = "一般";break;
                case 3:
                    str = "困难";break;
            }
            this.parentNode.nextElementSibling.children[0].innerHTML = str;
            y = true;
        }else{
            this.parentNode.nextElementSibling.children[0].innerHTML = "长度不符合";
            y = false
        }
    }

    pass2.onblur = function(){
        if(this.value == pass.value){
            this.parentNode.nextElementSibling.children[0].innerHTML = "一致";
            z = true
        }else{
            this.parentNode.nextElementSibling.children[0].innerHTML = "两次不一致";
            z = false
        }
    }

    //判断所有输入框的状态
    btn.onclick = function(){
        if(x&&y&&z){
            alert("提交成功")
        }else{
            alert("提交失败")
        }
    }

</script>
<script>
class Zhuce{
        constructor(){
            this.user = document.getElementById("user")
            this.pass = document.getElementById("pass")
            this.btn = document.getElementById("btn")
            this.span = document.querySelector("#span")

            this.addEvent()
        }
        addEvent(){
            var that = this;
            this.btn.onclick = function(){
                that.setLocal()
            }
        }
        setLocal(){
            // 之前有没有
            this.userMsg = localStorage.getItem("userMsg");
            this.userMsg = this.userMsg ? JSON.parse(this.userMsg) : [];

            // 之前没有，直接存
            if(this.userMsg.length<1){
                this.userMsg.push({
                    user:this.user.value,
                    pass:this.pass.value,
                    onoff:0
                })
            }else{
                // 之前有，判断是否重名
                var o = this.userMsg.some(val=>{
                    return val.user === this.user.value;
                })
                if(o){
                    this.span.innerHTML = "重名";
                }else{
                    this.span.innerHTML = "";
                    this.userMsg.push({
                        user:this.user.value,
                        pass:this.pass.value,
                        onoff:0
                    })
                }
            }

            localStorage.setItem("userMsg",JSON.stringify(this.userMsg))
        }
    }

    new Zhuce();



</script>
</html>
